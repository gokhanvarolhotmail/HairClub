{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "hc-eim-df-prod2"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/ODSLead')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateLeadFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedLeadFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Lead_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedLeadFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedLeadFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Lead_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedLead",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateLeadFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Lead\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedLeadDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Lead",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Leads",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedLeadFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedLead",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedLeadFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Lead\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedLeadDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Lead",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Leads",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedLeadFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedLead",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSLead",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "LeadParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedLeadFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsLead": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateLead",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSLead",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "LeadParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedLeadFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsLead": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedLeadDate": {
                        "type": "string"
                    },
                    "LastUpdatedLeadDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedLeadFileName": {
                        "type": "String"
                    },
                    "UpdatedLeadFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:19Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/DailyProcess')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DimStatus",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimStatus",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSCampaign": {},
                                    "ODSLead": {},
                                    "ODSAccount": {},
                                    "ODSServiceAppointment": {},
                                    "UpdateStatus": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimCurrency",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimCurrency",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSCampaign": {},
                                    "DimCurrency": {},
                                    "UpdateDimCurrency": {},
                                    "InsertDimCurrency": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimChannel",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimChannel",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "ODSCampaign": {},
                                    "SourceDimChannel": {},
                                    "UpdateDimChannel": {},
                                    "InsertDimChannel": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimLanguage",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimLanguage",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSCampaign": {},
                                    "DimLanguageSource": {},
                                    "DimLanguage": {},
                                    "InsertDimLanguage": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimMedia",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimStatus",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimCurrency",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimChannel",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimLanguage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimMedia",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSCampaign": {},
                                    "DimMedia": {},
                                    "UpdateDimMedia": {},
                                    "InsertDimMedia": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimLossReason",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimCurrency",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimChannel",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimLanguage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimLossReason",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSOpportunity": {},
                                    "DimLossReasonSource": {},
                                    "DimLossReason": {},
                                    "InsertDimLossReason": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimPromotion",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimCurrency",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimLanguage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimPromotion",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSPromoCode": {},
                                    "sourceDimPromocode": {},
                                    "InsertDimePromotion": {},
                                    "UpdateDimPromotion": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimCenter",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimSystemUSer",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimEthnicity",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimCenter",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ODSCenter": {},
                                    "ODSCenterOwnership": {},
                                    "ODSCenterType": {},
                                    "DimGeography": {},
                                    "SourceDimCenter": {},
                                    "OdsServiceTerritory": {},
                                    "ODScfgCenterManagementArea": {},
                                    "InsertDimCenter": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimAppointmentType",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimCenter",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimPromotion",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimAppointmentType",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSServiceAppointment": {},
                                    "AppointmentType": {},
                                    "InsertCompany": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimCampaign",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimMedia",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimLossReason",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimPromotion",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimCampaign",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSCampaign": {},
                                    "DimStatus": {},
                                    "DimAgency": {},
                                    "DimCurrency": {},
                                    "DimPromotion": {},
                                    "DimChannel": {},
                                    "DimLanguage": {},
                                    "DimMedia": {},
                                    "ODSTollFree": {},
                                    "ODSOldCampaing": {},
                                    "UpsertDimCampaign": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimLead",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimLead",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSLead": {},
                                    "DimTimeOfDay": {},
                                    "DimGeography": {},
                                    "DimDate": {},
                                    "DimEthnicity": {},
                                    "DimGender": {},
                                    "DimLanguage": {},
                                    "DimStatus": {},
                                    "DimMaritalStatus": {},
                                    "DimSource": {},
                                    "OriginalCampaignDataset": {},
                                    "DimCampaign": {},
                                    "DimCenter": {},
                                    "DimPromotion": {},
                                    "UpsertLead": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactAppointment",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimAccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimAppointmentType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactAppointment",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "11"
                                },
                                "datasetParameters": {
                                    "ODServiceAppointment": {},
                                    "DimDate": {},
                                    "DimTimeOfDay": {},
                                    "DimGeography": {},
                                    "DimAppointmentType": {},
                                    "DimMeetingPlatform": {},
                                    "DimAccount": {},
                                    "DimStatus": {},
                                    "DimLead": {},
                                    "DimCenter": {},
                                    "Event": {},
                                    "Opportunity": {},
                                    "FactLeadTracking": {},
                                    "InsertFactAppointment": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimAccount",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimAccount",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSAccount": {},
                                    "DimDate": {},
                                    "DimTimeOfDay": {},
                                    "DimSystemUser": {},
                                    "DimGeography": {},
                                    "DimEthnicity": {},
                                    "DimGender": {},
                                    "DimMaritalStatus": {},
                                    "DimCompany": {},
                                    "DimSource": {},
                                    "DimStatus": {},
                                    "UpsertDimAccount": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactCampaignHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimAccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactCampaignHistory",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSCampaignMember": {},
                                    "DimLead": {},
                                    "DimCampaign": {},
                                    "DimStatus": {},
                                    "DimGeography": {},
                                    "DimDate": {},
                                    "DimTimeOfDay": {},
                                    "UpsertCampaignHistory": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactOpportunity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimAccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactOpportunity",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSOppoprtunity": {},
                                    "DimDate": {},
                                    "DimLead": {},
                                    "DimAccount": {},
                                    "DimSystemUser": {},
                                    "DimLossReason": {},
                                    "DimCampaign": {},
                                    "UpsertFactOpportunity": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimSystemUSer",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimMembership",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimSystemUser",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSSFUser": {},
                                    "CNCTEmployee": {},
                                    "InsertIntoSystemUser": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimEthnicity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimEthnicity",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSAccount": {},
                                    "DimEthnicity": {},
                                    "ODSlkpEthnicity": {},
                                    "InsertEthnicity": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactCallDetail",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "DimLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "DimAccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactCallDetail",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ODSBPCallDetail": {},
                                    "DimDate": {},
                                    "DimeTimeOfDay": {},
                                    "DimAgentDisposition": {},
                                    "DimLead": {},
                                    "DimSource": {},
                                    "DimSystemUser": {},
                                    "DimCallType": {},
                                    "DimMedia": {},
                                    "DimScenario": {},
                                    "DimService": {},
                                    "FactCallDetail": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "BeBackFlagSP",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "FactOpportunity",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[sp_UpdateFactOpportunityBeBackFlag]"
                        },
                        "linkedServiceName": {
                            "referenceName": "HC_BI_Pool",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "UpdateDimLead",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "DimLead",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[UpdateDimLead]"
                        },
                        "linkedServiceName": {
                            "referenceName": "HC_BI_Pool",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "DimMembership",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimMembership",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "2"
                                },
                                "datasetParameters": {
                                    "ODSMembership": {},
                                    "DimGender": {},
                                    "ODSBusinessSegment": {},
                                    "ODSRevenueGroup": {},
                                    "UpdateDimMember": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "folder": {
                    "name": "Synapse"
                },
                "annotations": [],
                "lastPublishTime": "2022-02-11T01:24:18Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/TEST-1')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DimCenter",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimCenter",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ODSCenter": {},
                                    "ODSCenterOwnership": {},
                                    "ODSCenterType": {},
                                    "DimGeography": {},
                                    "SourceDimCenter": {},
                                    "OdsServiceTerritory": {},
                                    "ODScfgCenterManagementArea": {},
                                    "InsertDimCenter": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-dev"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "annotations": [],
                "lastPublishTime": "2021-09-24T14:20:26Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSTollFree')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateTollFreeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedTollFreeFileName",
                            "value": {
                                "value": "@Replace(concat('Created_TollFree_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedTollFreeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedTollFreeFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_TollFree_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedTollFree",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateTollFreeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM TollFreeNumbers__c\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedTollFreeDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_TollFree",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_TollFree",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedTollFreeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedTollFree",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedTollFreeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM TollFreeNumbers__c\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedTollFreeDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_TollFree",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_TollFree",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedTollFreeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedTollFree",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedTollFree",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedTollFree",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSTollFree",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "TollFreeParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedTollFreeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsTollFree": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateTollFree",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedTollFree",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSTollFree",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "TollFreeParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedTollFreeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsTollFree": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedTollFreeDate": {
                        "type": "string"
                    },
                    "LastUpdatedTollFreeDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedTollFreeFileName": {
                        "type": "String"
                    },
                    "UpdatedTollFreeFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSEvent')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateEventFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedEventFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Event_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedEventFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedEventFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Event_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedEvent",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateEventFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Event\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedEventDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Event",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Event",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedEventFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedEvent",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedEventFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Event\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedEventDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Event",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Event",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedEventFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedEvent",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedEvent",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedEvent",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSEvent",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "EventParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedEventFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsEvent": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateEvent",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedEvent",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSEvent",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "EventParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedEventFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsEvent": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedEventDate": {
                        "type": "string"
                    },
                    "LastUpdatedEventDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedEventFileName": {
                        "type": "String"
                    },
                    "UpdatedEventFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:30Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Television')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ExcelToParquet",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ExcelSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                }
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "MA_DL_Television",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@pipeline().parameters.FileName",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    },
                                    "SheetName": {
                                        "value": "@pipeline().parameters.SheetName",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_MA_Television",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_MA_Television",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ExcelToParquet",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODS_MA_Television",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "ColumnNames": "columnNames()",
                                    "FilePath": {
                                        "value": "'@{concat('MarketingAgencies/',pipeline().parameters.AgencyID, '/', pipeline().parameters.LA_ID, '/', pipeline().parameters.FileName)}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "DLTelevision": {
                                        "FileName": {
                                            "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                            "type": "Expression"
                                        },
                                        "LA_ID": {
                                            "value": "@pipeline().parameters.LA_ID",
                                            "type": "Expression"
                                        },
                                        "AgencyID": {
                                            "value": "@pipeline().parameters.AgencyID",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSTelevision": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactMarketingActivity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ODS_MA_Television",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactMarketingActivity",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "-1",
                                    "FilePath": {
                                        "value": "'@{pipeline().parameters.FileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "DimGeography": {},
                                    "DimAgency": {},
                                    "DimChannel": {},
                                    "DimFormat": {},
                                    "DimTactic": {},
                                    "DimSource": {},
                                    "DimPurpose": {},
                                    "DimCompany": {},
                                    "DimLocation": {},
                                    "DimLanguage": {},
                                    "DimDate": {},
                                    "DimAudience": {},
                                    "DimMethod": {},
                                    "DimMedium": {},
                                    "DimBudget": {},
                                    "ODSTargets": {},
                                    "DimTimeOfDay": {},
                                    "FactMarketing": {},
                                    "deleteMarketingActivity": {},
                                    "UpsertMarketing": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "FileName": {
                        "type": "string"
                    },
                    "AgencyID": {
                        "type": "string"
                    },
                    "LA_ID": {
                        "type": "string"
                    },
                    "SheetName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "MarketingAgencies"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:02Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Kingstar')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "IsExcel",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "SetDolarToday",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@endswith(pipeline().parameters.FileName, 'xlsx')",
                                "type": "Expression"
                            },
                            "ifFalseActivities": [
                                {
                                    "name": "KingstarCSV",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": true,
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "ParquetSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "ParquetWriteSettings"
                                            }
                                        },
                                        "enableStaging": false
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "UAT_SF_LEADS_CSV",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "FileName": {
                                                    "value": "@pipeline().parameters.FileName",
                                                    "type": "Expression"
                                                },
                                                "LA_ID": {
                                                    "value": "@pipeline().parameters.LA_ID",
                                                    "type": "Expression"
                                                },
                                                "AgencyID": {
                                                    "value": "@pipeline().parameters.AgencyID",
                                                    "type": "Expression"
                                                },
                                                "Container": "hc-eim-file-system-bi"
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "DL_MA_Kingstar_CSV",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "FileName": {
                                                    "value": "@replace(toLower(pipeline().parameters.FileName), '.csv', '.parquet')",
                                                    "type": "Expression"
                                                },
                                                "LA_ID": {
                                                    "value": "@pipeline().parameters.LA_ID",
                                                    "type": "Expression"
                                                },
                                                "AgencyID": {
                                                    "value": "@pipeline().parameters.AgencyID",
                                                    "type": "Expression"
                                                },
                                                "Container": "hc-eim-file-system-bi"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "name": "ODS_MA_KingstarCSV",
                                    "type": "ExecuteDataFlow",
                                    "dependsOn": [
                                        {
                                            "activity": "KingstarCSV",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataflow": {
                                            "referenceName": "ODS_MA_Kingstar_CSV",
                                            "type": "DataFlowReference",
                                            "parameters": {
                                                "FilePath": {
                                                    "value": "'@{concat('MarketingAgencies/',pipeline().parameters.AgencyID, '/', pipeline().parameters.LA_ID, '/', pipeline().parameters.FileName)}'",
                                                    "type": "Expression"
                                                },
                                                "DolarToday": {
                                                    "value": "'@{variables('DolarToday')}'",
                                                    "type": "Expression"
                                                }
                                            },
                                            "datasetParameters": {
                                                "CSVReport": {
                                                    "FileName": {
                                                        "value": "@replace(toLower(pipeline().parameters.FileName), '.csv', '.parquet')",
                                                        "type": "Expression"
                                                    },
                                                    "LA_ID": {
                                                        "value": "@pipeline().parameters.LA_ID",
                                                        "type": "Expression"
                                                    },
                                                    "AgencyID": {
                                                        "value": "@pipeline().parameters.AgencyID",
                                                        "type": "Expression"
                                                    },
                                                    "Container": "hc-eim-file-system-bi"
                                                },
                                                "ODSTelevision": {}
                                            }
                                        },
                                        "staging": {
                                            "linkedService": {
                                                "referenceName": "HC_DataLake",
                                                "type": "LinkedServiceReference"
                                            },
                                            "folderPath": "hc-eim-file-system-bi-staging"
                                        },
                                        "compute": {
                                            "coreCount": 8,
                                            "computeType": "General"
                                        },
                                        "traceLevel": "Fine"
                                    }
                                }
                            ],
                            "ifTrueActivities": [
                                {
                                    "name": "KingstarXLSX",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "ExcelSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": true,
                                                "enablePartitionDiscovery": false
                                            }
                                        },
                                        "sink": {
                                            "type": "ParquetSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "ParquetWriteSettings"
                                            }
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "typeConversion": true,
                                            "typeConversionSettings": {
                                                "allowDataTruncation": true,
                                                "treatBooleanAsNumber": false
                                            }
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "MA_DL_Television",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "FileName": {
                                                    "value": "@pipeline().parameters.FileName",
                                                    "type": "Expression"
                                                },
                                                "LA_ID": {
                                                    "value": "@pipeline().parameters.LA_ID",
                                                    "type": "Expression"
                                                },
                                                "AgencyID": {
                                                    "value": "@pipeline().parameters.AgencyID",
                                                    "type": "Expression"
                                                },
                                                "SheetName": {
                                                    "value": "@pipeline().parameters.SheetName",
                                                    "type": "Expression"
                                                },
                                                "Container": "hc-eim-file-system-bi"
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "DL_MA_Television",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "FileName": {
                                                    "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                                    "type": "Expression"
                                                },
                                                "LA_ID": {
                                                    "value": "@pipeline().parameters.LA_ID",
                                                    "type": "Expression"
                                                },
                                                "AgencyID": {
                                                    "value": "@pipeline().parameters.AgencyID",
                                                    "type": "Expression"
                                                },
                                                "Container": "hc-eim-file-system-bi"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "name": "ODS_MA_Kingstar_XLSX",
                                    "type": "ExecuteDataFlow",
                                    "dependsOn": [
                                        {
                                            "activity": "KingstarXLSX",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataflow": {
                                            "referenceName": "ODS_MA_Kingstar_XLSX",
                                            "type": "DataFlowReference",
                                            "parameters": {
                                                "FilePath": {
                                                    "value": "'@{concat('MarketingAgencies/',pipeline().parameters.AgencyID, '/', pipeline().parameters.LA_ID, '/', pipeline().parameters.FileName)}'",
                                                    "type": "Expression"
                                                },
                                                "DolarToday": {
                                                    "value": "'@{variables('DolarToday')}'",
                                                    "type": "Expression"
                                                }
                                            },
                                            "datasetParameters": {
                                                "XLSXReport": {
                                                    "FileName": {
                                                        "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                                        "type": "Expression"
                                                    },
                                                    "LA_ID": {
                                                        "value": "@pipeline().parameters.LA_ID",
                                                        "type": "Expression"
                                                    },
                                                    "AgencyID": {
                                                        "value": "@pipeline().parameters.AgencyID",
                                                        "type": "Expression"
                                                    },
                                                    "Container": "hc-eim-file-system-bi"
                                                },
                                                "DimTimeOfDay": {},
                                                "ODSTelevision": {}
                                            }
                                        },
                                        "staging": {
                                            "linkedService": {
                                                "referenceName": "HC_DataLake",
                                                "type": "LinkedServiceReference"
                                            },
                                            "folderPath": "hc-eim-file-system-bi-staging"
                                        },
                                        "compute": {
                                            "coreCount": 8,
                                            "computeType": "General"
                                        },
                                        "traceLevel": "Fine"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "DolarTodayAPI",
                        "type": "WebActivity",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "url": "https://api.exchangeratesapi.io/latest?symbols=USD,CAD&base=USD",
                            "method": "GET",
                            "headers": {}
                        }
                    },
                    {
                        "name": "SetDolarToday",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "DolarTodayAPI",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "DolarToday",
                            "value": "0.8"
                        }
                    },
                    {
                        "name": "FactMarketingActivity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "IsExcel",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactMarketingActivity",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "-1",
                                    "FilePath": {
                                        "value": "'@{pipeline().parameters.FileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "DimGeography": {},
                                    "DimAgency": {},
                                    "DimChannel": {},
                                    "DimFormat": {},
                                    "DimTactic": {},
                                    "DimSource": {},
                                    "DimPurpose": {},
                                    "DimCompany": {},
                                    "DimLocation": {},
                                    "DimLanguage": {},
                                    "DimDate": {},
                                    "DimAudience": {},
                                    "DimMethod": {},
                                    "DimMedium": {},
                                    "DimBudget": {},
                                    "ODSTargets": {},
                                    "DimTimeOfDay": {},
                                    "FactMarketing": {},
                                    "deleteMarketingActivity": {},
                                    "UpsertMarketing": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "FileName": {
                        "type": "string"
                    },
                    "AgencyID": {
                        "type": "string"
                    },
                    "LA_ID": {
                        "type": "string"
                    },
                    "SheetName": {
                        "type": "string"
                    }
                },
                "variables": {
                    "DolarToday": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "MarketingAgencies"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:01Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Canella')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "TXTToParquet",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "transactionid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "transactionid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CalendarDateEST",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "CalendarDateEST",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CalendarTimeEST",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "CalendarTimeEST",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BroadcastDateEST",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "BroadcastDateEST",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LocalAirTime",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "LocalAirTime",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "purpose",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "purpose",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "method",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "method",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Channel",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Channel",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Medium",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Medium",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "company",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "company",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "location",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BudgetType",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "BudgetType",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BudgetName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "BudgetName",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Source",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Source",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Affiliate",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Affiliate",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Station",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Station",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Show",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Show",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ContentType",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "ContentType",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Content",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Content",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CampaignType",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "CampaignType",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Campaign",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Campaign",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISCI",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "ISCI",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Master Number",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "MasterNumber",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TFN",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "TFN",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Sourcecode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Sourcecode",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PromoCode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "PromoCode",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "URL",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "URL",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Agency",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Agency",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Region",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Region",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DMACode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "DMACode",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DMAName",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "DMAName",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Audience",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Audience",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Tactic",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Tactic",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Placement",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Placement",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Format",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Format",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Language",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Language",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "GrossSpend",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "GrossSpend",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NetSpend",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "NetSpend",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Impressions18-65",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Impressions18-65",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "GRP",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "GRP",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Spots",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Spots",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Log Type",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "LogType",
                                            "physicalType": "UTF8"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "MA_DL_Canella",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@pipeline().parameters.FileName",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_MA_Canella",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@replace(pipeline().parameters.FileName, '.txt', '.parquet')",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_MA_Canella",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "TXTToParquet",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODS_MA_Canella",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "FilePath": {
                                        "value": "'@{concat('MarketingAgencies/', pipeline().parameters.AgencyID,'/',pipeline().parameters.LA_ID,'/',pipeline().parameters.FileName)}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "CanellaTXT": {
                                        "FileName": {
                                            "value": "@pipeline().parameters.FileName",
                                            "type": "Expression"
                                        },
                                        "LA_ID": {
                                            "value": "@pipeline().parameters.LA_ID",
                                            "type": "Expression"
                                        },
                                        "AgencyID": {
                                            "value": "@pipeline().parameters.AgencyID",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "DimTimeOfDay": {},
                                    "ODSTelevision": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactMarketingActivity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ODS_MA_Canella",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactMarketingActivity",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "-1",
                                    "FilePath": {
                                        "value": "'@{pipeline().parameters.FileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "DimGeography": {},
                                    "DimAgency": {},
                                    "DimChannel": {},
                                    "DimFormat": {},
                                    "DimTactic": {},
                                    "DimSource": {},
                                    "DimPurpose": {},
                                    "DimCompany": {},
                                    "DimLocation": {},
                                    "DimLanguage": {},
                                    "DimDate": {},
                                    "DimAudience": {},
                                    "DimMethod": {},
                                    "DimMedium": {},
                                    "DimBudget": {},
                                    "ODSTargets": {},
                                    "DimTimeOfDay": {},
                                    "FactMarketing": {},
                                    "deleteMarketingActivity": {},
                                    "UpsertMarketing": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "FileName": {
                        "type": "string"
                    },
                    "AgencyID": {
                        "type": "string"
                    },
                    "LA_ID": {
                        "type": "string"
                    }
                },
                "variables": {
                    "DolarToday": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "MarketingAgencies"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:03Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/MarketingDailyProcess')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DimMedia",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimMedia",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSCampaign": {},
                                    "DimMedia": {},
                                    "UpdateDimMedia": {},
                                    "InsertDimMedia": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimAudience",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimAudience",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "SourceDimAudience": {},
                                    "InsertDimAudience": {},
                                    "UpdateDimeAudience": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimChannel",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimChannel",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "ODSCampaign": {},
                                    "SourceDimChannel": {},
                                    "UpdateDimChannel": {},
                                    "InsertDimChannel": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimLocation",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimLocation",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSCampaign": {},
                                    "sourceDimLocation": {},
                                    "ODSTelevision": {},
                                    "ODSDatorama": {},
                                    "InsertDimLocation": {},
                                    "UpdateDimLocation": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimPurpose",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimPurpose",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "DimPurpose": {},
                                    "UpdateDimPurpose": {},
                                    "InsertDimPurpose": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimSource",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimSource",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSLead": {},
                                    "DimSource": {},
                                    "ODSAccount": {},
                                    "InsertDimSource": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimMethod",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimMethod",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "sourceDimMethod": {},
                                    "InsertDimMethod": {},
                                    "UpdateDimMethod": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimMedium",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimMedium",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "sourceDimMedium": {},
                                    "InsertDimMedium": {},
                                    "UpdateDimMedium": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DimCompany",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DimCompany",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "7500"
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "SourceDimCompany": {},
                                    "ODSDatorama": {},
                                    "InsertDimCompany": {},
                                    "UpdateDimCompany": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "folder": {
                    "name": "Synapse"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:01Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_datClient')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SF_DL_CreatedClient",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateClientFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.20:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM datClient\nWHERE CreateDate >='@{pipeline().parameters.LastCreateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "parallelCopies": 10,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_datClient",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_datClient",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedClientFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SetCreateClientFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedClientFileName",
                            "value": {
                                "value": "@Replace(concat('Create_Client_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedClientFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedClientFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Client_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_UpdatedClient",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedClientFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.20:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM datClient\nWHERE LastUpdate >='@{pipeline().parameters.LastUpdateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "parallelCopies": 10
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_datClient",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_datClient",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedClientFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ErrorNotification",
                        "type": "WebActivity",
                        "dependsOn": [
                            {
                                "activity": "ODS_CNCT_DatClientClient_Update",
                                "dependencyConditions": [
                                    "Failed",
                                    "Skipped"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "url": "https://prod-46.eastus2.logic.azure.com:443/workflows/04f510f1120b42ee8301c5db8d393580/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ycpAPQcmDk4Y5NcgZHjRvPkU7b-8eDQARyLP8fxsVzk",
                            "method": "POST",
                            "headers": {},
                            "body": {
                                "PipielineRunId": "@{pipeline().runID}",
                                "PipelineName": "@{pipeline().pipeline}",
                                "FailedDateTime": "@{utcnow()}"
                            }
                        }
                    },
                    {
                        "name": "ODS_CNCT_DatClientClient",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedClient",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedClient",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_datClient",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTdatClient": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedClientFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "ODS_CNCT_DatClientClient_Update",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ODS_CNCT_DatClientClient",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_datClient",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTdatClient": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedClientFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreateDate": {
                        "type": "string"
                    },
                    "LastUpdateDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedClientFileName": {
                        "type": "String"
                    },
                    "SimpleQuote": {
                        "type": "String",
                        "defaultValue": "'"
                    },
                    "UpdatedClientFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:01Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_DatClientMembership')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SF_DL_CreateddatClientMembership",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreatedatClientMembershipFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.20:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM datClientMembership\nWHERE CreateDate >='@{pipeline().parameters.LastCreateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "parallelCopies": 10,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_datClientMembership",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_datClientMembership",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedMembershipFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SetCreatedatClientMembershipFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedMembershipFileName",
                            "value": {
                                "value": "@Replace(concat('Create_datClientMembership_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdateddatClientMembershipFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedMembershipFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_datClientMembership_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_UpdateddatClientMembership",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdateddatClientMembershipFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.20:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM datClientMembership\nWHERE LastUpdate >='@{pipeline().parameters.LastUpdateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "parallelCopies": 10,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_datClientMembership",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_datClientMembership",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedMembershipFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ErrorNotification",
                        "type": "WebActivity",
                        "dependsOn": [
                            {
                                "activity": "ODS_CNCT_DatClientMembership_Update",
                                "dependencyConditions": [
                                    "Failed",
                                    "Skipped"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "url": "https://prod-46.eastus2.logic.azure.com:443/workflows/04f510f1120b42ee8301c5db8d393580/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ycpAPQcmDk4Y5NcgZHjRvPkU7b-8eDQARyLP8fxsVzk",
                            "method": "POST",
                            "headers": {},
                            "body": {
                                "PipielineRunId": "@{pipeline().runID}",
                                "PipelineName": "@{pipeline().pipeline}",
                                "FailedDateTime": "@{utcnow()}"
                            }
                        }
                    },
                    {
                        "name": "ODS_CNCT_DatClientMembership",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreateddatClientMembership",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdateddatClientMembership",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_datClientMembership",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "source1": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedMembershipFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "ODS_CNCT_DatClientMembership_Update",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ODS_CNCT_DatClientMembership",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_datClientMembership",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "source1": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedMembershipFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreateDate": {
                        "type": "string"
                    },
                    "LastUpdateDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedMembershipFileName": {
                        "type": "String"
                    },
                    "SimpleQuote": {
                        "type": "String",
                        "defaultValue": "'"
                    },
                    "UpdatedMembershipFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:39Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_cfgMembership')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "cfgMembership_Created",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_Created_cfgMembership",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_Updated_cfgMembership",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_cfgMembership",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTcfgMembership": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedcfgMembershipFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODScfgMembership": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "SetCreateMembershipFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedcfgMembershipFileName",
                            "value": {
                                "value": "@Replace(concat('Create_cfgMembership_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedMembershipFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedcfgMembershipFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_cfgMembership_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_Created_cfgMembership",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateMembershipFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM cfgMembership\nWHERE CreateDate >='@{pipeline().parameters.LastCreateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_cfgMembership",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_cfgMembership",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedcfgMembershipFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_Updated_cfgMembership",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedMembershipFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM cfgMembership\nWHERE LastUpdate >='@{pipeline().parameters.LastUpdateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_cfgMembership",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_cfgMembership",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedcfgMembershipFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "cfgMembership_Updated",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "cfgMembership_Created",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_cfgMembership",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTcfgMembership": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedcfgMembershipFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODScfgMembership": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreateDate": {
                        "type": "string"
                    },
                    "LastUpdateDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedcfgMembershipFileName": {
                        "type": "String"
                    },
                    " SimpleQuote": {
                        "type": "String",
                        "defaultValue": "'"
                    },
                    "UpdatedcfgMembershipFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:37:56Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSServiceResource')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateServiceResourceFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedServiceResourceFileName",
                            "value": {
                                "value": "@Replace(concat('Created_ServiceResource_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedServiceResourceFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedServiceResourceFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_ServiceResource_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedServiceResource",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateServiceResourceFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM ServiceResource\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedServiceResourceDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_ServiceResource",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_ServiceResource",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedServiceResourceFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedServiceResource",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedServiceResourceFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM ServiceResource\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedServiceResourceDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_ServiceResource",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_ServiceResource",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedServiceResourceFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "CreateServiceResource",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_UpdatedServiceResource",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_CreatedServiceResource",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSServiceResource",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "source1": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedServiceResourceFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateServiceResource",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "CreateServiceResource",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSServiceResource",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "source1": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedServiceResourceFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedServiceResourceDate": {
                        "type": "string"
                    },
                    "LastUpdatedServiceResourceDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedServiceResourceFileName": {
                        "type": "String"
                    },
                    "UpdatedServiceResourceFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:31Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSAssignedResource')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateAssignedResourceFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedAssignedResourceFileName",
                            "value": {
                                "value": "@Replace(concat('Created_AssignedResource_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedWorkTypeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedAssignedResourceFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_AssignedResource_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedWorkType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateAssignedResourceFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM AssignedResource\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedAssignedResourceDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_AssignedResource",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_AssaignedRessource",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedAssignedResourceFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedWorkType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedWorkTypeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM AssignedResource\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedAssignedResourceDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_AssignedResource",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_AssaignedRessource",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedAssignedResourceFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "CreateAssignedResource",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedWorkType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedWorkType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSAssignedResource",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "source1": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedAssignedResourceFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateAssignedResource",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "CreateAssignedResource",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSAssignedResource",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "source1": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedAssignedResourceFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedAssignedResourceDate": {
                        "type": "string"
                    },
                    "LastUpdatedAssignedResourceDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedAssignedResourceFileName": {
                        "type": "String"
                    },
                    "UpdatedAssignedResourceFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:19Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSOpportunityHistory')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateOpportunityHistoryFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedOpportunityHistoryFileName",
                            "value": {
                                "value": "@Replace(concat('Created_OpportunityHistory_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedOpportunitytHistory",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateOpportunityHistoryFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM OpportunityHistory\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedOpportunityHistoryDate}'\n",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_OpportunityHistory",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_OpportunityHistory",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedOpportunityHistoryFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_SF_OpportunityHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedOpportunitytHistory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSSFOpportunityHistory",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "DLOpportunityHistory": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedOpportunityHistoryFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSOpportunityHistory": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedOpportunityHistoryDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedOpportunityHistoryFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSAccountHistory')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateAccountHistoryFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedAccountHistoryFileName",
                            "value": {
                                "value": "@Replace(concat('Created_AccountHistory_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedAccountHistory",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateAccountHistoryFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM AccountHistory\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedAccountHistoryDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_AccountHistory",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_AccountHistory",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedAccountHistoryFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_SF_AccountHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedAccountHistory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSSFAccountHistory",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "DLAccountHistory": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedAccountHistoryFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSAccountHistory": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedAccountHistoryDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedAccountHistoryFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSLeadHistory')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateLeadHistoryFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedLeadHistoryFileName",
                            "value": {
                                "value": "@Replace(concat('Created_LeadHistory_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedLeadHistory",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateLeadHistoryFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM LeadHistory\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedLeadHistoryDate}'\n",
                                    "type": "Expression"
                                },
                                "readBehavior": "query"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_LeadsHistory",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_LeadHistory",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedLeadHistoryFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_SF_LeadHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedLeadHistory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSSFLeadHistory",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "DLLeadHistory": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedLeadHistoryFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSLeadHistory": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedLeadHistoryDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedLeadHistoryFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_ConectLog')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "CNT_DL_CreatedConectLog",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateConectLogFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.20:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM dbo.Log\nWHERE LEVEL = 'INFO' and LOGGER = 'icONEct.DataTransferObjects.DTOs.LogInformationDTO' and Date >='@{pipeline().parameters.LastCreateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "parallelCopies": 10,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_Log4Net_log",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_Logs",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedConectLogFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SetCreateConectLogFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedConectLogFileName",
                            "value": {
                                "value": "@Replace(concat('Create_Conect_Log_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "ODS_CNCT_ConnectHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "CNT_DL_CreatedConectLog",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_ConnectLog",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "DLLogs": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedConectLogFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSLogs": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreateDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedConectLogFileName": {
                        "type": "String"
                    },
                    "SimpleQuote": {
                        "type": "String",
                        "defaultValue": "'"
                    }
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:37:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSServiceAppointmentHistory')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateServAppHistoryFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedServAppHistoryFileName",
                            "value": {
                                "value": "@Replace(concat('Created_ServiceAppointmentHistory_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedServAppHistory",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateServAppHistoryFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM ServiceAppointmentHistory\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedServAppHistoryDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "query"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_ServiceAppointmentHistory",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_ServiceAppointmentHistory",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedServAppHistoryFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_SF_ServiceAppointmentHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedServAppHistory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSSFSAHistory",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "DLSAHistory": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedServAppHistoryFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSSAHistory": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedServAppHistoryDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedServAppHistoryFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_SF_Campaign')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateCampaignFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedCampaignFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Campaign_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedCampaignFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedCampaignFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Campaign_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedCampaign",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateCampaignFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Campaign\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedCampaignDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Campaign",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Campaign",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedCampaignFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedCampaign",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedCampaignFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Campaign\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedCampaignDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Campaign",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Campaign",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedCampaignFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedCampaign",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSCampaign",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CampaignParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedCampaignFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsCampaign": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateCampaign",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSCampaign",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CampaignParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedCampaignFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsCampaign": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedCampaignDate": {
                        "type": "string"
                    },
                    "LastUpdatedCampaignDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedCampaignFileName": {
                        "type": "String"
                    },
                    "UpdatedCampaignFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:00Z"
            },
            "dependsOn": []
        }
    ]
}