{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "hc-eim-df-prod2"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/ODSPromoCode')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreatePromoCodeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedPromoCodeFileName",
                            "value": {
                                "value": "@Replace(concat('Created_PromoCode_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedPromoCodeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedPromoCodeFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_PromoCode_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedPromoCode",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreatePromoCodeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM PromoCode__c\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedPromoCodeDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_PromoCode",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_PromoCode",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedPromoCodeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedPromoCode",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedPromoCodeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM PromoCode__c\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedPromoCodeDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_PromoCode",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_PromoCode",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedPromoCodeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedPromoCode",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedPromoCode",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedPromoCode",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSPromoCode",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "PromoCodeParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedPromoCodeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsPromoCode": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdatePromoCode",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedPromoCode",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSPromoCode",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "PromoCodeParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedPromoCodeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsPromoCode": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedPromoCodeDate": {
                        "type": "string"
                    },
                    "LastUpdatedPromoCodeDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedPromoCodeFileName": {
                        "type": "String"
                    },
                    "UpdatedPromoCodeFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSWorkType')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateWorkTypeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedWorkTypeFileName",
                            "value": {
                                "value": "@Replace(concat('Created_WorkType_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedWorkTypeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedWorkTypeFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_WorkType_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedWorkType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateWorkTypeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM WorkType\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedWorkTypeDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_WorkType",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_WorkType",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedWorkTypeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedWorkType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedWorkTypeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM WorkType\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedWorkTypeDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_WorkType",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_WorkType",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedWorkTypeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedWorkType",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedWorkType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedWorkType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSWorkType",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "WorkTypeParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedWorkTypeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsWorkType": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateWorkType",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedWorkType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSWorkType",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "WorkTypeParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedWorkTypeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsWorkType": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedWorkTypeDate": {
                        "type": "string"
                    },
                    "LastUpdatedWorkTypeDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedWorkTypeFileName": {
                        "type": "String"
                    },
                    "UpdatedWorkTypeFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/OTT_Intermedia')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "XLSXtoParquet",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ExcelSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                }
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "Date",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Date",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Advertiser",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Advertiser",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Advertiser Currency Code",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "AdvertiserCurrencyCode",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Campaign",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Campaign",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Ad Group",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "AdGroup",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Creative",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Creative",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Impressions",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "Impressions",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CN Spend ",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "CNSpend ",
                                            "physicalType": "UTF8"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "MA_DL_OTT_Intermedia",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@pipeline().parameters.FileName",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    },
                                    "SheetName": {
                                        "value": "@pipeline().parameters.SheetName",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_MA_Intermedia_OTT",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_MA_OTT_Intermedia",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "XLSXtoParquet",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODS_MA_OTT_Intermedia",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "FilePath": {
                                        "value": "'@{concat('MarketingAgencies/',pipeline().parameters.AgencyID, '/', pipeline().parameters.LA_ID, '/', pipeline().parameters.FileName)}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "ODSOTT": {
                                        "FileName": {
                                            "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                            "type": "Expression"
                                        },
                                        "LA_ID": {
                                            "value": "@pipeline().parameters.LA_ID",
                                            "type": "Expression"
                                        },
                                        "AgencyID": {
                                            "value": "@pipeline().parameters.AgencyID",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi-dev-staging"
                                    },
                                    "sinkODS": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "FileName": {
                        "type": "string"
                    },
                    "AgencyID": {
                        "type": "string"
                    },
                    "LA_ID": {
                        "type": "string"
                    },
                    "SheetName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "MarketingAgencies"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:01Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSCampaign')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateCampaignFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedCampaignFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Campaign_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedCampaignFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedCampaignFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Campaign_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedCampaign",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateCampaignFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Campaign\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedCampaignDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Campaign",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Campaign",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedCampaignFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedCampaign",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedCampaignFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Campaign\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedCampaignDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Campaign",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Campaign",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedCampaignFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedCampaign",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSCampaign",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CampaignParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedCampaignFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsCampaign": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateCampaign",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedCampaign",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSCampaign",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CampaignParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedCampaignFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsCampaign": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedCampaignDate": {
                        "type": "string"
                    },
                    "LastUpdatedCampaignDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedCampaignFileName": {
                        "type": "String"
                    },
                    "UpdatedCampaignFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:31Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSOrder')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateOrderFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedOrderFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Order_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedOrderFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedOrderFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Order_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedOrder",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateOrderFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Order\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedOrderDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Order",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Order",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedOrderFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedOrder",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedOrderFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Order\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedOrderDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Order",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Order",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedOrderFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedOrder",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedOrder",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedOrder",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSOrder",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "OrderParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedOrderFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsOrder": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateOrder",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedOrder",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSOrder",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "OrderParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedOrderFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsOrder": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedOrderDate": {
                        "type": "string"
                    },
                    "LastUpdatedOrderDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedOrderFileName": {
                        "type": "String"
                    },
                    "UpdatedOrderFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:30Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSOpportunity')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateOpportunityFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedOpportunityFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Opportunity_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedOpportunityFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedOpportunityFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Opportunity_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedOpportunity",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateOpportunityFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Opportunity\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedOpportunityDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Opportunity",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Opportunity",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedOpportunityFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedOpportunity",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedOpportunityFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Opportunity\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedOpportunityDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Opportunity",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Opportunity",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedOpportunityFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedOpportunity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedOpportunity",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedOpportunity",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSOpportunity",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "OpportunityParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedOpportunityFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsOpportunity": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateOpportunity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedOpportunity",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSOpportunity",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "OpportunityParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedOpportunityFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsOpportunity": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedOpportunityDate": {
                        "type": "string"
                    },
                    "LastUpdatedOpportunityDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedOpportunityFileName": {
                        "type": "String"
                    },
                    "UpdatedOpportunityFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:31Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_PaymentSalesCode')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "CNCTPaymentSalesCode",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_PaymentSalesCode",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "source1": {
                                        "Object_File_Name": "History.parquet",
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:37:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSAccount')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateAccountFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedAccountFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Account_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedAccountFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedAccountFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Account_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedAccount",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateAccountFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Account\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedAccountDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Account",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Account",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedAccountFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedAccount",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedAccountFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Account\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedAccountDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Account",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Account",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedAccountFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedAccount",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedAccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedAccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSAccount",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "AccountParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedAccountFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsAccount": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateAccount",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedAccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSAccount",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "AccountParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedAccountFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsAccount": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedAccountDate": {
                        "type": "string"
                    },
                    "LastUpdatedAccountDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedAccountFileName": {
                        "type": "String"
                    },
                    "UpdatedAccountFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:30Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_SalesType')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SalesType_Created",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_Created_SalesCodeType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_Updated_SalesCodeType",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_SalesType",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNTSalesType": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedSalesCodeTypeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSSalesType": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "SetCreateSalesCodeTypeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedSalesCodeTypeFileName",
                            "value": {
                                "value": "@Replace(concat('Create_SalesCodeType_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedSalesCodeTypeFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedSalesCodeTypeFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_SalesCodeType_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_Created_SalesCodeType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateSalesCodeTypeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM lkpSalesCodeType\nWHERE CreateDate >='@{pipeline().parameters.LastCreateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_SalesType",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_SalesType",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedSalesCodeTypeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_Updated_SalesCodeType",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedSalesCodeTypeFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM lkpSalesCodeType\nWHERE LastUpdate >='@{pipeline().parameters.LastUpdateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_SalesType",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_SalesType",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedSalesCodeTypeFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SalesType_Updated",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SalesType_Created",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_SalesType",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNTSalesType": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedSalesCodeTypeFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSSalesType": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreateDate": {
                        "type": "string"
                    },
                    "LastUpdateDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedSalesCodeTypeFileName": {
                        "type": "String"
                    },
                    " SimpleQuote": {
                        "type": "String",
                        "defaultValue": "'"
                    },
                    "UpdatedSalesCodeTypeFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:00Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/DatoramaReport')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ExcelToParquet",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "ExcelSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                }
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Datorama_DL_SocialMedia",
                                "type": "DatasetReference",
                                "parameters": {
                                    "SheetName": {
                                        "value": "@pipeline().parameters.SheetName",
                                        "type": "Expression"
                                    },
                                    "FileName": {
                                        "value": "@pipeline().parameters.FileName",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_Datorama_SocialMedia",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_Datorama_SocialMedia",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ExcelToParquet",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODS_Datorama_SocialMedia",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "FilePath": {
                                        "value": "'@{concat('SocialMedia/Datorama/',pipeline().parameters.AgencyID,'/' ,pipeline().parameters.LA_ID, '/',pipeline().parameters.FileName)}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "DLSocialMedia": {
                                        "FileName": {
                                            "value": "@replace(pipeline().parameters.FileName, '.xlsx', '.parquet')",
                                            "type": "Expression"
                                        },
                                        "LA_ID": {
                                            "value": "@pipeline().parameters.LA_ID",
                                            "type": "Expression"
                                        },
                                        "AgencyID": {
                                            "value": "@pipeline().parameters.AgencyID",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSSocialMEdia": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactMarketingActivity_Datorama",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ODS_Datorama_SocialMedia",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactMarketingActivity_Datorama",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "-1",
                                    "FilePath": {
                                        "value": "'@{pipeline().parameters.FileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "ODSSocialMedia": {},
                                    "DimAgency": {},
                                    "DimSource": {},
                                    "DimBudget": {},
                                    "DimLocation": {},
                                    "DimCompany": {},
                                    "DimDate": {},
                                    "DimChannel": {},
                                    "DimMedium": {},
                                    "DimMarketingFeed": {},
                                    "FactMarketingBudget": {},
                                    "InsertFactMarketingActivity": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "FileName": {
                        "type": "string"
                    },
                    "AgencyID": {
                        "type": "string"
                    },
                    "LA_ID": {
                        "type": "string"
                    },
                    "SheetName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SocialMedia"
                },
                "annotations": [],
                "lastPublishTime": "2022-03-07T15:06:43Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Havas')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "TabToParquet",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "transactionid",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "transactionid",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendardateest",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "calendardateest",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendartimeest",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "calendartimeest",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "broadcastdateest",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "broadcastdateest",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "localairtime",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "localairtime",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "purpose",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "purpose",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "method",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "method",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "channel",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "channel",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "medium",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "medium",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "company",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "company",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "location",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "budgettype",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "budgettype",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "budgetname",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "budgetname",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "source",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "affiliate",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "affiliate",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "station",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "station",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "show",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "show",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "contenttype",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "contenttype",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "content",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "content",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "campaigntype",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "campaigntype",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "campaign",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "campaign",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "isci",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "isci",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "masternumber",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "masternumber",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tfn",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "tfn",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sourcecode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "sourcecode",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "promocode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "promocode",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "url",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "url",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "agency",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "agency",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "region",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "region",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "dmacode",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "dmacode",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "dmaname",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "dmaname",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "audience",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "audience",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tactic",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "tactic",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "placement",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "placement",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "format",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "format",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "language",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "language",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "grossspend",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "grossspend",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "netspend",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "netspend",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "[[impressions18-65]",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "[[impressions18-65]",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "grp",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "grp",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "spots",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "spots",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "logtype",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "logtype",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "MA_DL_Havas",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@pipeline().parameters.FileName",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_MA_Havas",
                                "type": "DatasetReference",
                                "parameters": {
                                    "FileName": {
                                        "value": "@replace(pipeline().parameters.FileName, '.tab', '.parquet')",
                                        "type": "Expression"
                                    },
                                    "LA_ID": {
                                        "value": "@pipeline().parameters.LA_ID",
                                        "type": "Expression"
                                    },
                                    "AgencyID": {
                                        "value": "@pipeline().parameters.AgencyID",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "ODS_MA_Havas",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "TabToParquet",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODS_MA_Havas",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "FilePath": {
                                        "value": "'@{concat('MarketingAgencies/', pipeline().parameters.AgencyID,'/',pipeline().parameters.LA_ID,'/',pipeline().parameters.FileName)}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "HavasParquet": {
                                        "FileName": {
                                            "value": "@replace(pipeline().parameters.FileName, '.tab', '.parquet')",
                                            "type": "Expression"
                                        },
                                        "LA_ID": {
                                            "value": "@pipeline().parameters.LA_ID",
                                            "type": "Expression"
                                        },
                                        "AgencyID": {
                                            "value": "@pipeline().parameters.AgencyID",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSTelevision": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "FactMarketingActivity",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "ODS_MA_Havas",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactMarketingActivity",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "-1",
                                    "FilePath": {
                                        "value": "'@{pipeline().parameters.FileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "ODSTelevision": {},
                                    "DimGeography": {},
                                    "DimAgency": {},
                                    "DimChannel": {},
                                    "DimFormat": {},
                                    "DimTactic": {},
                                    "DimSource": {},
                                    "DimPurpose": {},
                                    "DimCompany": {},
                                    "DimLocation": {},
                                    "DimLanguage": {},
                                    "DimDate": {},
                                    "DimAudience": {},
                                    "DimMethod": {},
                                    "DimMedium": {},
                                    "DimBudget": {},
                                    "ODSTargets": {},
                                    "DimTimeOfDay": {},
                                    "FactMarketing": {},
                                    "deleteMarketingActivity": {},
                                    "UpsertMarketing": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "FileName": {
                        "type": "string"
                    },
                    "AgencyID": {
                        "type": "string"
                    },
                    "LA_ID": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "MarketingAgencies"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:01Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSUser')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateUserFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedUserFileName",
                            "value": {
                                "value": "@Replace(concat('Created_User_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedUserFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedUserFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_User_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedUser",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateUserFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM User\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedUserDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_User",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_User",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedUserFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedUser",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedUserFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM User\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedUserDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_User",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_User",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedUserFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedUser",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedUser",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedUser",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSUser",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "UserParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedUserFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsUser": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateUser",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedUser",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSUser",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "UserParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedUserFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsUser": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedUserDate": {
                        "type": "string"
                    },
                    "LastUpdatedUserDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedUserFileName": {
                        "type": "String"
                    },
                    "UpdatedUserFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:30Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSTask')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateTaskFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedTaskFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Task_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedTaskFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedTaskFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Task_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedTask",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateTaskFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Task\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedTaskDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Task",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Task",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedTaskFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedTask",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedTaskFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Task\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedTaskDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Task",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Task",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedTaskFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedTask",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedTask",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedTask",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSTask",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "TaskParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedTaskFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsTask": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateTask",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedTask",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSTask",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "TaskParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedTaskFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsTask": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedTaskDate": {
                        "type": "string"
                    },
                    "LastUpdatedTaskDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedTaskFileName": {
                        "type": "String"
                    },
                    "UpdatedTaskFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/TEST-2')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "FactAppointment",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FactAppointment",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "DaysToLoad": "11"
                                },
                                "datasetParameters": {
                                    "ODServiceAppointment": {},
                                    "DimDate": {},
                                    "DimTimeOfDay": {},
                                    "DimGeography": {},
                                    "DimAppointmentType": {},
                                    "DimMeetingPlatform": {},
                                    "DimAccount": {},
                                    "DimStatus": {},
                                    "DimLead": {},
                                    "DimCenter": {},
                                    "Event": {},
                                    "Opportunity": {},
                                    "FactLeadTracking": {},
                                    "InsertFactAppointment": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "annotations": [],
                "lastPublishTime": "2021-12-09T06:22:08Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_RevenueGroup')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "RevenueGroup_Created",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_Created_RevenueGroup",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_Updated_RevenueGroup",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_RevenueGroup",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTRevenueGroup": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedRevenueGroupFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSRevenueGroup": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "SetCreateRevenueGroupFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedRevenueGroupFileName",
                            "value": {
                                "value": "@Replace(concat('Create_RevenueGroup_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedRevenueGroupFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedRevenueGroupFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_RevenueGroup_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_Created_RevenueGroup",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateRevenueGroupFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM lkpRevenueGroup\nWHERE CreateDate >='@{pipeline().parameters.LastCreateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_RevenueGroup",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_RevenueGroup",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedRevenueGroupFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_Updated_RevenueGroup",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedRevenueGroupFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM lkpRevenueGroup\nWHERE LastUpdate >='@{pipeline().parameters.LastUpdateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_RevenueGroup",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_RevenueGroup",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedRevenueGroupFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "RevenueGroup_Updated",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "RevenueGroup_Created",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_RevenueGroup",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTRevenueGroup": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedRevenueGroupFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSRevenueGroup": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreateDate": {
                        "type": "string"
                    },
                    "LastUpdateDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedRevenueGroupFileName": {
                        "type": "String"
                    },
                    "SimpleQuote": {
                        "type": "String"
                    },
                    "UpdatedRevenueGroupFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:38:00Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODS_CNCT_Gender')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "CNCTGender_Created",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_Created_Gender",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_Updated_Gender",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_Gender",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTlkpGender": {
                                        "Object_File_Name": {
                                            "value": "@activity('SF_DL_Created_Gender').output",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSlkpGender": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "SetCreateGenderFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedGenderFileName",
                            "value": {
                                "value": "@Replace(concat('Create_lkpGender_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedGenderFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedGenderFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_lkpGender_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_Created_Gender",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateGenderFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM lkpGender\nWHERE CreateDate >='@{pipeline().parameters.LastCreateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_Gender",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_Gender",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedGenderFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_Updated_Gender",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedGenderFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT * FROM lkpGender\nWHERE LastUpdate >='@{pipeline().parameters.LastUpdateDate}'",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SQL01_DL_Gender",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_CNCT_Gender",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedGenderFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "CNCTGender_Updated",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "CNCTGender_Created",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "CNCT_Gender",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CNCTlkpGender": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedGenderFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "ODSlkpGender": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreateDate": {
                        "type": "string"
                    },
                    "LastUpdateDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedGenderFileName": {
                        "type": "String"
                    },
                    " SimpleQuote": {
                        "type": "String",
                        "defaultValue": "'"
                    },
                    "UpdatedGenderFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Connect/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-10-15T16:37:52Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSServiceTerritory')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateServiceTerritoryFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedServiceTerritoryFileName",
                            "value": {
                                "value": "@Replace(concat('Created_ServiceTerritory_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedServiceTerritoryFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedServiceTerritoryFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_ServiceTerritory_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedServiceTerritory",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateServiceTerritoryFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM ServiceTerritory\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedServiceTerritoryDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_ServiceTerritory",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_ServiceTerritory",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedServiceTerritoryFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedServiceTerritory",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedServiceTerritoryFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM ServiceTerritory\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedServiceTerritoryDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_ServiceTerritory",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_ServiceTerritory",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedServiceTerritoryFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedServiceTerritory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedServiceTerritory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedServiceTerritory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSServiceTerritory",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ServiceTerritoryParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedServiceTerritoryFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsServiceTerritory": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateServiceTerritory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedServiceTerritory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSServiceTerritory",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ServiceTerritoryParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedServiceTerritoryFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsServiceTerritory": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedServiceTerritoryDate": {
                        "type": "string"
                    },
                    "LastUpdatedServiceTerritoryDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedServiceTerritoryFileName": {
                        "type": "String"
                    },
                    "UpdatedServiceTerritoryFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSProduct')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateProductFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedProductFileName",
                            "value": {
                                "value": "@Replace(concat('Created_Product_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedProductFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedProductFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_Product_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedProduct",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateProductFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Product2\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedProductDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Product",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Product",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@pipeline().parameters.LastCreatedProductDate",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedProduct",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedProductFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM Product2\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedProductDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_Product",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_Product",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedProductFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedProduct",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedProduct",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedProduct",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSProduct",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ProductParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedProductFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsProduct": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateProduct",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedProduct",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSProduct",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ProductParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedProductFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsProduct": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedProductDate": {
                        "type": "string"
                    },
                    "LastUpdatedProductDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedProductFileName": {
                        "type": "String"
                    },
                    "UpdatedProductFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSCampaignMember')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateCampaignMemberFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedCampaignMemberFileName",
                            "value": {
                                "value": "@Replace(concat('Created_CampaignMember_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedCampaignMemberFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedCampaignMemberFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_CampaignMember_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedCampaignMember",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateCampaignMemberFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM CampaignMember\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedCampaignMemberDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_CampaignMember",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_CampaignMember",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedCampaignMemberFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedCampaignMember",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedCampaignMemberFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM CampaignMember\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedCampaignMemberDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_CampaignMember",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_CampaignMember",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedCampaignMemberFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedCampaignMember",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedCampaignMember",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedCampaignMember",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSCampaignMember",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CampaignMemberParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedCampaignMemberFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsCapaignMember": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateCampaignMember",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedCampaignMember",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "1.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSCampaignMember",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "CampaignMemberParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedCampaignMemberFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsCapaignMember": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedCampaignMemberDate": {
                        "type": "string"
                    },
                    "LastUpdatedCampaignMemberDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedCampaignMemberFileName": {
                        "type": "String"
                    },
                    "UpdatedCampaignMemberFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:30Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ODSServiceAppointment')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SetCreateServiceAppointmentFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "CreatedServiceAppointmentFileName",
                            "value": {
                                "value": "@Replace(concat('Created_ServiceAppointment_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetUpdatedServiceAppointmentFileName",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "UpdatedServiceAppointmentFileName",
                            "value": {
                                "value": "@Replace(concat('Updated_ServiceAppointment_', pipeline().RunId, '_',utcnow('yyyy-MM-ddTHH:mm:ss'), '.parquet'), ':','-')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SF_DL_CreatedServiceAppointment",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetCreateServiceAppointmentFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM ServiceAppointment\nWHERE CreatedDate >='@{pipeline().parameters.LastCreatedServiceAppointmentDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_ServiceAppointment",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_ServiceAppointment",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('CreatedServiceAppointmentFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "SF_DL_UpdatedServiceAppointment",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SetUpdatedServiceAppointmentFileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SalesforceServiceCloudSource",
                                "query": {
                                    "value": "SELECT * FROM ServiceAppointment\nWHERE LastModifiedDate >='@{pipeline().parameters.LastUpdatedServiceAppointmentDate}'",
                                    "type": "Expression"
                                },
                                "readBehavior": "queryAll"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "SF_DL_ServiceAppointment",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DL_SF_ServiceAppointment",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Object_File_Name": {
                                        "value": "@variables('UpdatedServiceAppointmentFileName')",
                                        "type": "Expression"
                                    },
                                    "Container": "hc-eim-file-system-bi"
                                }
                            }
                        ]
                    },
                    {
                        "name": "InsertCreatedServiceAppointment",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "SF_DL_CreatedServiceAppointment",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            },
                            {
                                "activity": "SF_DL_UpdatedServiceAppointment",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSServiceAppointment",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ServiceAppointmentParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('CreatedServiceAppointmentFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsServiceAppointment": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "UpdateServiceAppointment",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "InsertCreatedServiceAppointment",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "ODSServiceAppointment",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "ServiceAppointmentParquet": {
                                        "Object_File_Name": {
                                            "value": "@variables('UpdatedServiceAppointmentFileName')",
                                            "type": "Expression"
                                        },
                                        "Container": "hc-eim-file-system-bi"
                                    },
                                    "UpsertOdsServiceAppointment": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "HC_DataLake",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "hc-eim-file-system-bi-staging"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {},
                    "cancelAfter": {}
                },
                "parameters": {
                    "LastCreatedServiceAppointmentDate": {
                        "type": "string"
                    },
                    "LastUpdatedServiceAppointmentDate": {
                        "type": "string"
                    },
                    "LARunId": {
                        "type": "string"
                    }
                },
                "variables": {
                    "CreatedServiceAppointmentFileName": {
                        "type": "String"
                    },
                    "UpdatedServiceAppointmentFileName": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Salesforce/ODS"
                },
                "annotations": [],
                "lastPublishTime": "2021-08-12T22:37:19Z"
            },
            "dependsOn": []
        }
    ]
}