/* CreateDate: 02/18/2011 17:50:43.353 , ModifyDate: 07/30/2012 10:18:16.210 */
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- EXEC dbaHairOrderPurchaseOrderImport

CREATE PROCEDURE [dbo].[dbaHairOrderPurchaseOrderImport_FixFactory]

AS

DECLARE @PurchaseOrderStatus_SENT integer
DECLARE @PurchaseOrderType_HKE integer
DECLARE @Vendor_INACTIVE integer
DECLARE @HairSystemAllocationFilter_FILTER4 integer

BEGIN

SELECT @HairSystemAllocationFilter_FILTER4 = HairSystemAllocationFilterID FROM lkpHairSystemAllocationFilter WHERE HairSystemAllocationFilterDescriptionShort = 'FILTER4'
SELECT @PurchaseOrderStatus_SENT = PurchaseOrderStatusID FROM lkpPurchaseOrderStatus WHERE PurchaseOrderStatusDescriptionShort = 'SENT'
SELECT @PurchaseOrderType_HKE = PurchaseOrderTypeID FROM lkpPurchaseOrderType WHERE PurchaseOrderTypeDescriptionShort = 'HKE'
SELECT @Vendor_INACTIVE = VendorID FROM cfgVendor WHERE VendorDescriptionShort = 'HK'

--datPurchaseOrder
INSERT INTO datPurchaseOrder (PurchaseOrderGUID,
                                                VendorID,
                                                PurchaseOrderDate,
                                                PurchaseOrderNumberOriginal,
                                                PurchaseOrderTotal,
                                                PurchaseOrderCount,
                                                PurchaseOrderStatusID,
                                                HairSystemAllocationGUID,
                                                PurchaseOrderTypeID,
                                                CreateDate,
                                                CreateUser,
                                                LastUpdate,
                                                LastUpdateUser)
                        SELECT NEWID(),
                                    orders.VendorID,
                                    orders.PurchaseOrderDate,
                                    orders.PurchaseOrderNumberOriginal,
                                    orders.PurchaseOrderTotal,
                                    orders.PurchaseOrderCount,
                                    orders.PurchaseOrderStatusID,
                                    orders.HairSystemAllocationGUID,
                                    orders.PurchaseOrderTypeID,
                                    GETUTCDATE(),
                                    'sa',
                                    GETUTCDATE(),
                                    'sa'
                        FROM (
                              SELECT DISTINCT   ISNULL(v.VendorID, @Vendor_INACTIVE) AS VendorID,
                                    o.forderdate AS PurchaseOrderDate,
                                    o.hponumber AS PurchaseOrderNumberOriginal,
                                    0 AS PurchaseOrderTotal,
                                    0 AS PurchaseOrderCount,
                                    @PurchaseOrderStatus_SENT AS PurchaseOrderStatusID,
                                    NULL AS HairSystemAllocationGUID,
                                    @PurchaseOrderType_HKE AS PurchaseOrderTypeID
                              FROM	[BOSProduction].[dbo].[Orders] o
                                    LEFT OUTER JOIN [cfgVendor] v ON o.factactual = v.VendorDescriptionShort
                              WHERE hponumber in (3011363,
3011217,
3011171,
3011340,
3010965,
3011380,
3011400,
3014148,
3011131,
3011177,
3011423,
3011031,
3011569,
3011234,
3011303,
3011446,
3011280,
3011257,
3011194,
3010991,
3011068,
3011360,
3011260,
3011091,
3011489,
3011297,
3011483,
3011506,
3014231,
3011466,
3011921,
3010945,
3011443,
3010985,
3011323,
3011197,
3011088,
3011111,
3014028,
3011214,
3011237,
3013919,
3011386,
3011409,
3011309,
3011117,
3011140,
3011432,
3011103,
3011203,
3010934,
3011326,
3011349,
3010957,
3011415,
3011077,
3014243,
3011289,
3010997,
3011163,
3011429,
3010951,
3011183,
3011037,
3011475,
3011452,
3011950,
3011266,
3011498,
3014240,
3011223,
3011269,
3011369,
3010977,
3013496,
3011097,
3011346,
3011246,
3011512,
3010971,
3011017,
3013699,
3013482,
3011401,
3011501,
3011209,
3011332,
3014149,
3011693,
3013788,
3012838,
3011232,
3011564,
3011126,
3010980,
3011318,
3011172,
3014226,
3011478,
3011149,
3011255,
3011438,
3011461,
3011484,
3011358,
3011146,
3012128,
3011335,
3011006,
3011083,
3011298,
3011106,
3011275,
3011129,
3011252,
3011229,
3011375,
3010960,
3011152,
3011192,
3011212,
3011000,
3011189,
3011395,
3011464,
3010940,
3011026,
3011418,
3011378,
3011355,
3011292,
3014146,
3010972,
3011072,
3011493,
3011470,
3011364,
3011424,
3011616,
3013697,
3011341,
3010966,
3011507,
3011012,
3012048,
3011281,
3011430,
3013365,
3011178,
3011115,
3011218,
3011304,
3011092,
3011321,
3013800,
3011805,
3010952,
3011344,
3010992,
3013239,
3011404,
3011384,
3011158,
3011035,
3011112,
3011135,
3011676,
3011238,
3010946,
3010986,
3011410,
3011261,
3011284,
3011198,
3014227,
3011187,
3011456,
3011479,
3014241,
3011078,
3011224,
3011270,
3011141,
3011247,
3011227,
3011327,
3010935,
3011373,
3011350,
3010975,
3011476,
3011453,
3011931,
3011390,
3011459,
3011313,
3013700,
3011015,
3011184,
3011619,
3011353,
3011290,
3011396,
3011001,
3011330,
3011307,
3013557,
3014224,
3011370,
3011167,
3010978,
3010955,
3011433,
3010941,
3011087,
3010987,
3011279,
3011379,
3011256,
3011631,
3011502,
3010981,
3011319,
3011399,
3011193,
3011107,
3010967,
3010944,
3011485,
3011030,
3011359,
3011233,
3011213,
3011336,
3011007,
3011130,
3011153,
3010961,
3011113,
3011259,
3011488,
3011173,
3011127,
3011419,
3012006,
3011027,
3011465,
3011150,
3011293,
3011442,
3011299,
3011276,
3011425,
3011339,
3011202,
3011010,
3011033,
3011471,
3011325,
3011448,
3011348,
3010973,
3013658,
3011494,
3011302,
3014242,
3013695,
3011162,
3011116,
3011265,
3011365,
3011219,
3012095,
3011093,
3011242,
3010950,
3012848,
3011076,
3011617,
3011139,
3011697,
3013486,
3011428,
3011405,
3011199,
3011391,
3011345,
3011322,
3011176,
3011368,
3011451,
3013701,
3011511,
3011016,
3011073,
3011285,
3011385,
3010993,
3011136,
3011222,
3011308,
3011245,
3011125,
3011271,
3010956,
3013266,
3011188,
3011102,
3011294,
3011208,
3011334,
3011892,
3010936,
3010982,
3011460,
3011374,
3011414,
3011500,
3011437,
3011022,
3010976,
3011168,
3011497,
3011228,
3011251,
3011082,
3011314,
3011420,
3011122,
3011145,
3010939,
3010962,
3011457,
3014225,
3011354,
3011434,
3011025,
3011002,
3011480,
3011331,
3011935,
3011394)  ) orders




-- PurchaseOrderDetail Insert
INSERT INTO [dbo].[datPurchaseOrderDetail](
                                    PurchaseOrderDetailGUID,
                                    PurchaseOrderGUID,
                                    HairSystemOrderGUID,
                                    HairSystemAllocationFilterID,
                                    CreateDate,
                                    CreateUser,
                                    LastUpdate,
                                    LastUpdateUser)
SELECT NEWID(),
            po.PurchaseOrderGUID,
            hso.HairSystemOrderGUID,
            @HairSystemAllocationFilter_FILTER4,
            GETUTCDATE(),
            'sa',
            GETUTCDATE(),
            'sa'
FROM [BOSProduction].[dbo].[Orders] o
      LEFT OUTER JOIN [cfgVendor] v ON o.factactual = v.VendorDescriptionShort
      INNER JOIN [dbo].[datPurchaseOrder] po ON o.hponumber = po.PurchaseOrderNumberOriginal AND ISNULL(v.VendorID, @Vendor_INACTIVE) = po.VendorID
      INNER JOIN [dbo].[datHairSystemOrder] hso ON o.serialnumb = hso.hairSystemOrderNumber
WHERE o.hponumber in (3011363,
3011217,
3011171,
3011340,
3010965,
3011380,
3011400,
3014148,
3011131,
3011177,
3011423,
3011031,
3011569,
3011234,
3011303,
3011446,
3011280,
3011257,
3011194,
3010991,
3011068,
3011360,
3011260,
3011091,
3011489,
3011297,
3011483,
3011506,
3014231,
3011466,
3011921,
3010945,
3011443,
3010985,
3011323,
3011197,
3011088,
3011111,
3014028,
3011214,
3011237,
3013919,
3011386,
3011409,
3011309,
3011117,
3011140,
3011432,
3011103,
3011203,
3010934,
3011326,
3011349,
3010957,
3011415,
3011077,
3014243,
3011289,
3010997,
3011163,
3011429,
3010951,
3011183,
3011037,
3011475,
3011452,
3011950,
3011266,
3011498,
3014240,
3011223,
3011269,
3011369,
3010977,
3013496,
3011097,
3011346,
3011246,
3011512,
3010971,
3011017,
3013699,
3013482,
3011401,
3011501,
3011209,
3011332,
3014149,
3011693,
3013788,
3012838,
3011232,
3011564,
3011126,
3010980,
3011318,
3011172,
3014226,
3011478,
3011149,
3011255,
3011438,
3011461,
3011484,
3011358,
3011146,
3012128,
3011335,
3011006,
3011083,
3011298,
3011106,
3011275,
3011129,
3011252,
3011229,
3011375,
3010960,
3011152,
3011192,
3011212,
3011000,
3011189,
3011395,
3011464,
3010940,
3011026,
3011418,
3011378,
3011355,
3011292,
3014146,
3010972,
3011072,
3011493,
3011470,
3011364,
3011424,
3011616,
3013697,
3011341,
3010966,
3011507,
3011012,
3012048,
3011281,
3011430,
3013365,
3011178,
3011115,
3011218,
3011304,
3011092,
3011321,
3013800,
3011805,
3010952,
3011344,
3010992,
3013239,
3011404,
3011384,
3011158,
3011035,
3011112,
3011135,
3011676,
3011238,
3010946,
3010986,
3011410,
3011261,
3011284,
3011198,
3014227,
3011187,
3011456,
3011479,
3014241,
3011078,
3011224,
3011270,
3011141,
3011247,
3011227,
3011327,
3010935,
3011373,
3011350,
3010975,
3011476,
3011453,
3011931,
3011390,
3011459,
3011313,
3013700,
3011015,
3011184,
3011619,
3011353,
3011290,
3011396,
3011001,
3011330,
3011307,
3013557,
3014224,
3011370,
3011167,
3010978,
3010955,
3011433,
3010941,
3011087,
3010987,
3011279,
3011379,
3011256,
3011631,
3011502,
3010981,
3011319,
3011399,
3011193,
3011107,
3010967,
3010944,
3011485,
3011030,
3011359,
3011233,
3011213,
3011336,
3011007,
3011130,
3011153,
3010961,
3011113,
3011259,
3011488,
3011173,
3011127,
3011419,
3012006,
3011027,
3011465,
3011150,
3011293,
3011442,
3011299,
3011276,
3011425,
3011339,
3011202,
3011010,
3011033,
3011471,
3011325,
3011448,
3011348,
3010973,
3013658,
3011494,
3011302,
3014242,
3013695,
3011162,
3011116,
3011265,
3011365,
3011219,
3012095,
3011093,
3011242,
3010950,
3012848,
3011076,
3011617,
3011139,
3011697,
3013486,
3011428,
3011405,
3011199,
3011391,
3011345,
3011322,
3011176,
3011368,
3011451,
3013701,
3011511,
3011016,
3011073,
3011285,
3011385,
3010993,
3011136,
3011222,
3011308,
3011245,
3011125,
3011271,
3010956,
3013266,
3011188,
3011102,
3011294,
3011208,
3011334,
3011892,
3010936,
3010982,
3011460,
3011374,
3011414,
3011500,
3011437,
3011022,
3010976,
3011168,
3011497,
3011228,
3011251,
3011082,
3011314,
3011420,
3011122,
3011145,
3010939,
3010962,
3011457,
3014225,
3011354,
3011434,
3011025,
3011002,
3011480,
3011331,
3011935,
3011394)


END
GO
